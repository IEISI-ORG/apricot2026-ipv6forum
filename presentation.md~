---
marp: true
theme: gaia
class: lead
backgroundColor: #fff
paginate: true
style: |
  section {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }
  h1 {
    color: #2c3e50;
  }
  h2 {
    color: #e67e22;
  }
  strong {
    color: #2980b9;
  }
---

<!-- _class: lead invert -->

# Project IPv6-First
## A Case Study in Achieving an 80%+ Native IPv6 SOHO Network

**Terry Sweetser**
*December 2025*

---

## The Objective
**Is a near-native IPv6-first environment achievable in 2025?**

*   **Goal:** Maximize the native IPv6 traffic ratio on a sophisticated SOHO network.
*   **Method:** Data-driven analysis using NetFlow (Akvorado).
*   **Challenge:** Identify and remediate residual IPv4 traffic sources without using transition technologies like CLAT (yet).

---

## The Baseline Environment

Starting from a robust dual-stack foundation:

*   **ISP:** Aussie Broadband (Native IPv6 /48).
*   **Gateway:** MikroTik (RouterOS).
*   **DNS:** Pi-hole + Unbound (Pure IPv6 infrastructure).
*   **Philosophy:** Local services running on planned IPv6 addresses (e.g., `::cafe`, `::beef`).

---

### The Problem
Despite this "perfect" setup, historical analysis showed the network was only achieving **67.7% IPv6 traffic**.

---

## Methodology: The "Find and Fix" Loop

1.  **Establish Baseline:** Analyze destination ports and protocols via Akvorado.
2.  **Isolate Laggards:** Identify high-bandwidth applications defaulting to IPv4.
3.  **Targeted Intervention:** Reconfigure applications to force IPv6 compliance.
4.  **Validate:** Measure the "After" state.

---

## The Invisible Accelerator: Local DNS & Happy Eyeballs

The "IPv6-First" success relies on a local DNS stack (Pi-hole + Unbound) that optimizes the **Happy Eyeballs v2 (RFC 8305)** race.

<style scoped>
p { font-size: 24px; }
li { font-size: 22px; margin-bottom: 15px; }
strong { color: #d35400; }
em { color: #2980b9; font-style: normal; font-weight: bold; }
</style>

1.  **The "Resolution Delay" (50ms):**
    *   *Standard:* Browsers wait only 50ms for an IPv6 (`AAAA`) record if IPv4 arrives first.
    *   *Your Edge:* Unbound resolves in **microseconds**. The `AAAA` record never arrives "late," so the browser never defaults to IPv4 during lookup.

2.  **The "Connection Head Start" (~250ms):**
    *   Because the IPv6 address is available instantly, the OS starts the IPv6 connection immediately.
    *   It waits **~250ms** before attempting IPv4.
    *   *Result:* IPv6 runs unopposed for a quarter of a second.

> **Key Takeaway:** Local DNS resolution removes the "latency penalty" from the race, ensuring IPv6 is not just *preferred*, but mathematically *destined* to win.

---

## The Primary Culprit: BitTorrent

**Initial Status:**
BitTorrent was a significant drag on the network, operating at only **44% IPv6**.

**The "Working" Dual-Stack Trap:**
*   The client was bound to "Any Interface."
*   It accepted IPv4 peer connections from trackers immediately.
*   **Result:** It defaulted to a suboptimal IPv4 NAT path rather than waiting for superior IPv6 peers.

---

## The Intervention: Surgical Exclusion

Instead of "preferring" IPv6, the solution was to **enforce** it.

*   **Action:** Bound the BitTorrent client exclusively to the **IPv6 Network Interface**.
*   **Effect:** Removed the ability to fallback to IPv4.
*   **Outcome:** The client was forced to seek high-performance IPv6 seedboxes and data center peers.

---

## Results: The Shift

**Application Level:**
*   BitTorrent traffic flipped from 44% to **92.6% IPv6**.

**Network Level:**
*   The structural change lifted the entire network's stable operational average from ~67% to **79.2%**.

> "The era of IPv4 dominance is over for well-configured networks."

---

## December 2025 Update: Breaking the 90% Barrier

Recent SQL analysis (Dec 7 â€“ Dec 22, 2025) shows continued optimization has pushed the network even further.

| Metric | Long Term (Oct-Dec) | **Short Term (Dec 7-22)** |
| :--- | :---: | :---: |
| Total Flows | 3.3M | 28.1M |
| **IPv6 Bytes %** | 81.19% | **90.74%** |

*The network is now operating as a effectively IPv6-Native environment.*

---

<!-- _footer: Data Source: report_short_term query -->

## Visualizing the Data

```sql
SELECT * FROM report_short_term
-- Query result: Dec 7 to Dec 22
-- IPv6 Flow Percent: 95.01%
-- IPv6 Bytes Percent: 90.74%
```

![width:800px drop-shadow](https://i.imgur.com/placeholder-chart.png)
*(Ref: Akvorado SQL Analysis confirming >90% IPv6 byte ratio)*

---

## Macro vs. Micro: Validating the Data

<style scoped>
/* This shrinks the text just for this slide to make it fit */
table {
    font-size: 22px;
    width: 100%;
}
th, td {
    padding: 5px 10px !important;
}
p {
    font-size: 24px;
    margin-bottom: 20px;
}
h2 {
    margin-bottom: 10px;
}
</style>

My SOHO network mirrors global adoption curves, suggesting that **~80%** is the current "natural limit" for standard dual-stack implementation.

| Context | IPv6 Ratio | Status |
| :--- | :---: | :--- |
| **Germany** (National) | **66.67%** | Strong legacy infrastructure drag |
| **My Network** (Baseline) | **67.70%** | Default configs favoring IPv4 |
| **India** (National) | **78.90%** | Mobile-first / Greenfields architecture |
| **France** (National) | **79.23%** | Aggressive ISP migration |
| **My Network** (Optimized) | **79.20%** | Active deprecation of IPv4 paths |
| **My Network** (Dec '25) | **90.74%** | **The "IPv6-Native" Frontier** |

**Key Insight:**
*We can manually achieve today what the global internet will naturally reach in ~5 years.*

---

## Defining the "IPv4 Floor"

The remaining ~10-20% of IPv4 traffic is irreducible without CLAT/NAT64. It consists of:

1.  **Legacy IoT:** Ring cameras (IPv4-only video upload).
2.  **Legacy Web Services:** 
    *   Amazon.com (Main retail site).
    *   GitHub.com (Main site, though assets are v6).
3.  **ISP Infrastructure:** Aussie Broadband caching/accelerators.

---

## Conclusion & The Path Forward

**The Case is Made:**
A home network in late 2025 can operate as an overwhelmingly IPv6 environment (>90%).

**The Final Hurdle:**
To bridge the final "IPv4 Floor," we need vendor support for **CLAT** (Customer-Located Address Translation) on gateways like MikroTik.

Until then, **90% is the new standard.**

---

<!-- _class: invert -->

## The Final 10%: A Call to Action

One barrier remaining between **90%** and **100%** is the lack of native **CLAT** (Customer-Located Address Translation) in MikroTik RouterOS.

Without CLAT, we cannot fully deprecate IPv4 on the LAN side for legacy devices (IoT).

### ðŸ“¢ We Need Your Voice
Support Feature Request **#263487** to bring native 464XLAT to RouterOS.

**[forum.mikrotik.com/t/feature-request-464xlat/263487](https://forum.mikrotik.com/t/feature-request-464xlat/263487)**

> "We have optimized the network. Now we need the vendor to optimize the gateway."
